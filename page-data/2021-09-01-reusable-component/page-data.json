{"componentChunkName":"component---src-templates-blog-post-js","path":"/2021-09-01-reusable-component/","result":{"data":{"site":{"siteMetadata":{"title":"Juvantia"}},"markdownRemark":{"id":"aa54fbc2-8901-5bc5-bd8b-19356a7f40fc","excerpt":"들어가며 풀스택 CRUD 게시판을 하나 만들어보자 라는 생각으로 21.08.15에 시작한 동아리 | 소모임 게시판 서비스 Ginger…","html":"<h3>들어가며</h3>\n<p>풀스택 CRUD 게시판을 하나 만들어보자 라는 생각으로 21.08.15에 시작한 동아리 | 소모임 게시판 서비스 Ginger의 코드 <a href=\"https://github.com/codeKiuk/Ginger\"><code class=\"language-text\">https://github.com/codeKiuk/Ginger</code></a> 를 천천히 뜯어보며 리팩토링 하기로 마음먹었다.</p>\n<p>내가 쓴 코드가 일단 돌아만 가는 <del>개노답</del> 코드라는 걸 알고는 있었지만 뭘 어떻게 만들어야 확장성이 좋은 코드인지, 어떻게 짜는 것이 클-린한지 몰랐다.</p>\n<p>그러다가 <a href=\"https://jbee.io/etc/what-is-good-code/\"><code class=\"language-text\">https://jbee.io/etc/what-is-good-code/</code></a> 글을 보고 조금의 힌트를 얻어, 선배님이 생각하시는 좋은 코드의 기준인</p>\n<ol>\n<li>\n<p>의존성이 잘 드러나도록 추상화되어 있는가</p>\n</li>\n<li>\n<p>확장성 있는 컴포넌트인가</p>\n</li>\n</ol>\n<p>에 맞춰 리팩토링을 진행하기로 했다.</p>\n<h3>프로젝트 구조 파악</h3>\n<p>의존성을 잘 드러내는 추상화 (한 파일이 하나의 목적을 갖도록 로직 분리) 를 이루기 위해서는</p>\n<p>우선 프로젝트의 구조를 파악해 어떤 로직들이 존재하고,</p>\n<p>이 로직들이 어느 파일에 어떻게 존재하는지 파악하는 것이 먼저다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 536px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c73f1db809f9a38a9a882b213c354544/2d920/redux.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 181.64556962025316%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAYAAACJ8xqgAAAACXBIWXMAABYlAAAWJQFJUiTwAAADnklEQVR42qVWyZLiVhDsT7BnhkVsQrvQjjYkgZCABrqx+zB98HZ0+Ozw/1/SUQW9YKIHMT5UBP2eOqOysirr3Xnr3xAu9kjqJ9SHX/HHX//g9z//xnz3DL/YIywPN8WdHG2h+iWMaAV7tkV2/4zy4Rf4xSP0cAVtWkENlo3jri2M0OqOMBA1DEYKbD9FsdyirB+wuv8ZY8XCl84QbUFsFHfd3hgUg5HKgGPZhOVGcPwEL3e3xBlgbyBDUiZIswp+mPN5uzu6HbDTG2MoqhD6ErpGCN2JUSw2SLMa3jS7CfQCUFBsaNYUthvDmARQdAcd4X9kKOgBTC/FZveEWVHDCzO0OsNj9t8FqLrQ7RBJVjFd10+hGV5j2peAmgvNCpEvNgjjOQPqE/8EKH0HoBkyZRKFepGEIdVHYwMdQby9bfqizkJQdtSLEyeCpFp8R99dq+VFYyuyyRkleYUoLZGX9xiKGj59FlgcisaUOQMjgGaHmEYFonSJeFZhUe0QJgv40wwTO/ymQG+AoxeVHciGB8sJ4QYzph2EORw/5d7UTb8h4DtR7DBHvTlwZsv1I+bLLbeRqjv43Op/s45nNewPFXYd0w65fkSTBBqNdQ66v0ll+gdJMRGlC85olq8gSiZ++NTFl/agUXOfi3KirHGGC84yzWtucvqt6u6ryh/15GUNZQuy7rEA5IssjJfAtAL2SmJB331E/xJwEkF3E5TV7lWYorzHcvWAan3A/qdnPt89fuVzUTbPsr2oIRXfC2ZMUTM9DEWdg+9P03RcFyrHfxW/ABxLBqtLgDRyLEirz6K8fEsZvcR1x56E0JwIcVqiKLcsSDZfc4OTIO/BPgYU3tVQMqEYHhw/fp0O05qyJxILUTLOKDcQJeadMstrtq98fsyQRKG1unv4ivX2iQWi86s1JFHIVKmxp/Gc9woJQSH0ZQZ4+1u6PinUa6RyPCtR1nvokwA/nialRXGqY3NzmEQw3ARZsWK1ifp8uWPwNK8QJvNXs70OSDTkCVTTZ8uy3JjVdYMUtpfw5Cia3XCWqUl7Itq6z7NMOyWZLZHxbtljVqw4SOHrfiiIGNGcWjEcN+YepAzJoUmk218OgojhWEdPdWBYAabJglcAUSaxjtYl3gY4kkz0neOWI2rV5sBTQnSzxRppUTP4tVX6lqFkoKd5UA0PQZTzhNheDFm1+EVG7dTkOfKOsoGeFSGICiyqPRsrPelanaNTdxo+Rf4F+vkBKWbD13kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"redux 구조\"\n        title=\"\"\n        src=\"/static/c73f1db809f9a38a9a882b213c354544/2d920/redux.png\"\n        srcset=\"/static/c73f1db809f9a38a9a882b213c354544/c26ae/redux.png 158w,\n/static/c73f1db809f9a38a9a882b213c354544/6bdcf/redux.png 315w,\n/static/c73f1db809f9a38a9a882b213c354544/2d920/redux.png 536w\"\n        sizes=\"(max-width: 536px) 100vw, 536px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>redux 구조</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 536px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fef6e1e3dbfe821eb084683c78371436/2d920/route.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.632911392405056%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABLklEQVR42p2Ry07CUABE+QdjgSKPktIXFHrb2wKXQlseRmhkCerOqFsT/39xDCxcGmBxdpOTmUzFX74g0i0y37PYHjm8f/P29UNWvjKa7RDz8ioqvXiLLTK8ZIPI9zwfPykPH4TzEjsqcOQSS+TYYXERFa3e4b7W4cFwqLox9kASqxVpsSNRS2bZE0OhuNNaVPUuWt34l0pN71Ctt2l2LPSej+WMCMQEtx/i9gWmNaDeMDjlLuFP2DJsdDfE8yXTdEUQTYknGf2hRKu1bhM23AjbCxirHDleIJM5hundJmyeGvaGWO5JWOCPEhxP0DU9anr71skRYZySZo/kqx1qvmYyW+IHY7Rq8wZhz8cPEkSkEFIRhNNzU9P2z5nrJp9edsT5jGJdohYbQqmuPuYXJFAlsbgm7pwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Route\"\n        title=\"\"\n        src=\"/static/fef6e1e3dbfe821eb084683c78371436/2d920/route.png\"\n        srcset=\"/static/fef6e1e3dbfe821eb084683c78371436/c26ae/route.png 158w,\n/static/fef6e1e3dbfe821eb084683c78371436/6bdcf/route.png 315w,\n/static/fef6e1e3dbfe821eb084683c78371436/2d920/route.png 536w\"\n        sizes=\"(max-width: 536px) 100vw, 536px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Route</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 536px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8e95f0ee5f8a26b49e2fea25ed90deea/2d920/components.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 199.36708860759492%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAoCAYAAAD+MdrbAAAACXBIWXMAABYlAAAWJQFJUiTwAAAEs0lEQVR42p1WW2/iZhDNL+hKTQIYfMXGxvcbNgYD5rKETZRkpUiblbbqPmxfW6nt/5dONQNOkwIJ6cPI2OY7mplz5ozPkuozKPLVAxb3v+Lh++94/PEnHr7/gS8//sLX3/7GePOIaHqH+r+H4x7h4gvOrGQOCidbIpneYH7zFev7X7C6+4bq+hHL228Iig3MuEL938NRwczWOGu0u7gUNIhaHx3ZhBsWGE6vEA/nyMs1TDfDh4sOzpvKU9D/6dzzoGeC1MNZq62AQpK76BgONCuAHwxguzG8YADHSxBEOSw7hGF66Fk+ZKWHpiCjPktB9x1ZJ0AVFJLURbsXQLJCDPIp0nyKolwiLypkxRzz1Q2SbMLPLCdGo0WAGurzTUFBRzb2AdV+hEE2YcBsOMOwXGI4XiDNJgzYd2NcNEQInX/BDgPKOtq6B9kMEMZDOH4KPxrCCzIG98MMtpug1w925apvAFKGZgjFjjEulxhNP2JSXaFa3TAgZdloSbhsSi9KfSNDB6LuIowLROkYcTrmDHtWwCXW8V+wV3somQHyYsbNz4pqCxrmnNkxsIOAotRFxwqZ5SQdYTxboyhXSLKSgTuSwYdOBqSSBd2BYgUIiYwwhx/lCOICfTeBpPSOgr1KimrHmM7WqJY3GJVLlNUV4kHJ94rW3+lPPZUUF7Lpsw6ph8QukWJ7Kdpi930ZUg8F3WNh03QQYDFZsZjjtHyVkD1AulE0E6raQzIoMRwvMZqsECYjnF92cNkUXwU7AKhy0ynUrg3bS7aluglE2XihwWNa3C9ZNjh0w2YiqGzK0gsz/HzR5vm94GwlXDQ6e+QcIMWAIOoQzBB2kLGg02zKE1MHse3Su8EYuukxSJ3tYUBJh2D4sNwEUVKwjVEfnwO5wYC1qffcXX+l44BtyrCfwPYHmC0+sTlQ2eSHZA7FZInFx1t+vljfoZytMRjOGOywDlULHc2GZUeIkhGbBE2M6w/ghzn307RDzo5C1W2o3f5xHbatCLIdoygq5KM5ZzKdf0K1vMZ0vsGk2rBHnl+2mRSK5o6cPR3KqglZMXiP5MUcQTTcHhDkXUnba+uIQRwA3OqQtEdEUIn0rtFS/q8OdSZG61psW2RZVCY5DmmQ2NxqcPu7Qfct6cnSjspG7PncJ8qQyqbdovc8GJYPw/J445n9HTGmx1XVrTggmy5aZgjTTXhSytkVkzPe7ReSCcmGgrKn56SAWov7fmhF0MgPqzWLmYLWZi3gFyXzwpJfK1lHW+tD1B12bOodadByIn6/JeI5Kdpb9mVBU014forV5h6Ol+KnD5dsDHV2794p5NhaP0KalUwMzS9905i7aEvd03T45Ni9gEEJkEggtyb50LwSIVTFSTuFha1tJ4UcZjy9QjFeIkq3jk1E0PXkksmx6RNNVEw4QYYwKZAOp5ydIHZ5J7fJ2t616EUNQj+GZEWo5hu2K9Lgcn2LYbnAbHHNY0lyefPbpp5lWgFBVDAhtKxoUmgSOpL+dD1567HbyDrvZLIpypAcmnfJrofPHfo0lq0YipPypPCi37FLv4lxagHNNpX95gcnzbGgmPzxTiuUAOgwGQFpkD40SexdwznIdg34D2RCgAY/t4PAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"components\"\n        title=\"\"\n        src=\"/static/8e95f0ee5f8a26b49e2fea25ed90deea/2d920/components.png\"\n        srcset=\"/static/8e95f0ee5f8a26b49e2fea25ed90deea/c26ae/components.png 158w,\n/static/8e95f0ee5f8a26b49e2fea25ed90deea/6bdcf/components.png 315w,\n/static/8e95f0ee5f8a26b49e2fea25ed90deea/2d920/components.png 536w\"\n        sizes=\"(max-width: 536px) 100vw, 536px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 536px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/20fd3728878c6c0f5c95852ee8cfc700/2d920/hoc.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.949367088607595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA6ElEQVR42o3My26CUACEYR5CK2IqYK1yUzQCBxRQKDeNjalJk66b9P0f4TeycEG76OLLbGZGspIri7DE3R0Jiyunz2+C/IIjKpZRwyKqH/kfkhl/4IiC1e5EkF04f/20h3MvxwqKlum/4YT1H6pfpCdFpz/UGOkmsiUwHJ8kOxLGJdu0ZiMObMS+7fQGY/qySk9W27xvuyRZ0RgMVZ71GaPXBTNjyWoT4a4F9tJrOa7PZGoxmdpoEwP9xWSszblvux6HY91AsT3W3pY0a0gONXn5TpxWiO2BeF+RFWeSrEHscvwwbXfdwxvOFpv9F4ODVwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Higher Order Components\"\n        title=\"\"\n        src=\"/static/20fd3728878c6c0f5c95852ee8cfc700/2d920/hoc.png\"\n        srcset=\"/static/20fd3728878c6c0f5c95852ee8cfc700/c26ae/hoc.png 158w,\n/static/20fd3728878c6c0f5c95852ee8cfc700/6bdcf/hoc.png 315w,\n/static/20fd3728878c6c0f5c95852ee8cfc700/2d920/hoc.png 536w\"\n        sizes=\"(max-width: 536px) 100vw, 536px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Higher Order Components</p>\n<p>Ginger 클라이언트 디렉토리는 어떤 기능을 하는지 (component인지, route page인지, redux인지) 에 따라 폴더 구조를 나눴다.</p>\n<ol>\n<li>이 구조가 가질 수 있는 문제점은 플젝 규모가 커지면 코드가 정의된 곳과 이를 사용하는 곳이 멀어질 수 있다는 점.. <del>사실 이미 좀 멀어져 있다.</del></li>\n<li>또한 MVC라든지 MVVM라든지 디자인 패턴에 대한 지식 없이 구성해서 좋은 의존성에 대한 고민을 많이 못 했다. ⇒ ( components/commons/Pagination.tsx 이라는 컴포넌트 안에 pagination view 로직이 들어있는 동시에 컨텐츠를 가져오는 상태 관련 로직이 동시에 존재하는 등 의존성 분리를 하지 못 했다. )</li>\n</ol>\n<h3>문제 찾아보기</h3>\n<p>먼저 프로젝트 코드 전반적으로 redux와 thunk를 통해 전역 상태와 data fetch를 다루면서 재사용 가능한 컴포넌트를 많이 만들지 못 했다. (redux 덕분에 자식 컴포넌트에 props를 내려주는 일을 거의 안 하면서..)</p>\n<p>그럼에도 불구하고 확장성을 생각한 포인트로는</p>\n<p>→ withPaperContainer라는 고차컴포넌트를 통해 동아리 게시판 전체 글을 불러오거나 내가 쓴 글, 댓글을 불러오는 등 컨텐츠를 fetch하는 <strong>중복되는 로직</strong>을 한 곳에서 처리했다.</p>\n<p>그렇다면 이 외에 재사용 가능하도록 만들어볼 <del>구린</del> 컴포넌트 혹은 view로직과 상태 로직이 같이 있는 복잡한 컴포넌트를 찾아보자.</p>\n<blockquote>\n<p>Sidebar</p>\n</blockquote>\n<p>Sidebar에서 메뉴를 클릭하면 클릭한 메뉴가 어떤 메뉴인지 전역 store에 ContentSubject라는 enum 타입을 통해 저장한다. 이후 해당하는 컨텐츠(글or댓글 등)를 불러오는 함수를 dispatch한다.</p>\n<p>그런데 Sidebar에서 메뉴 클릭 후 라우트를 mypage 혹은 home으로 옮겨오는데, 이 때 각 라우트를 구성하는 컴포넌트의 useEffect에서도 Sidebar에서와 마찬가지로 컨텐츠를 불러오는 함수를 dispatch한다.</p>\n<p>따라서 개발 당시 만들었던 중복 로직을 삭제해줬다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// 수정된 Sidebar.tsx</span>\n<span class=\"token comment\">// 클릭한 메뉴에 따라 전역 store에 알려주는 함수에서 중복 로직 삭제</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onClickContentsMenu</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>title<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'동아리 / 학회'</span><span class=\"token operator\">:</span>\n      <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">setContentSubject</span><span class=\"token punctuation\">(</span>ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">CLUB_CONTENT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 중복로직 삭제 => dispatch(getClubContents({ page: 1, perPage: perPage }));</span>\n      <span class=\"token keyword\">break</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'스터디 / 소모임'</span><span class=\"token operator\">:</span>\n      <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">setContentSubject</span><span class=\"token punctuation\">(</span>ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">GROUP_CONTENT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 중복로직 삭제 => dispatch(getGroupContents({ page: 1, perPage: perPage }));</span>\n      <span class=\"token keyword\">break</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'내가 쓴 글'</span><span class=\"token operator\">:</span>\n      <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">setContentSubject</span><span class=\"token punctuation\">(</span>ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">MY_CONTENT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 중복로직 삭제 => dispatch(getMyContents({ userID: userID ,page: 1, perPage: perPage }));</span>\n      <span class=\"token keyword\">break</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'내가 쓴 댓글'</span><span class=\"token operator\">:</span>\n      <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">setContentSubject</span><span class=\"token punctuation\">(</span>ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">MY_COMMENT</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">// 중복로직 삭제 => dispatch(getMyComments({ userID: userID ,page: 1, perPage: perPage }));</span>\n      <span class=\"token keyword\">break</span>\n    <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n      <span class=\"token keyword\">break</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>Pagination</p>\n</blockquote>\n<p>글을 쓰게 된 계기인 <del>개구린</del> 페이지네이션 컴포넌트.</p>\n<p>먼저 바뀌기 전 코드를 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// Pagination.tsx</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> Pagination<span class=\"token operator\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span><span class=\"token operator\">&lt;</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> contentsLoading <span class=\"token operator\">=</span> <span class=\"token function\">useAppSelector</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>contents<span class=\"token punctuation\">.</span>loading<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> myCommentsLoading <span class=\"token operator\">=</span> <span class=\"token function\">useAppSelector</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>myComments<span class=\"token punctuation\">.</span>loading<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> myContentsLoading <span class=\"token operator\">=</span> <span class=\"token function\">useAppSelector</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>myContents<span class=\"token punctuation\">.</span>loading<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> loading <span class=\"token operator\">=</span> contentsLoading <span class=\"token operator\">||</span> myCommentsLoading <span class=\"token operator\">||</span> myContentsLoading\n  <span class=\"token keyword\">const</span> contentSubject <span class=\"token operator\">=</span> <span class=\"token function\">useAppSelector</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> state<span class=\"token punctuation\">.</span>contentMenu<span class=\"token punctuation\">.</span>contentSubject<span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// ...</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onPageClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>pageNum<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>contentSubject<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">case</span> ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">CLUB_CONTENT</span><span class=\"token operator\">:</span>\n        <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">getClubContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> page<span class=\"token operator\">:</span> pageNum<span class=\"token punctuation\">,</span> perPage<span class=\"token operator\">:</span> perPage <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">break</span>\n      <span class=\"token keyword\">case</span> ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">GROUP_CONTENT</span><span class=\"token operator\">:</span>\n        <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">getGroupContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> page<span class=\"token operator\">:</span> pageNum<span class=\"token punctuation\">,</span> perPage<span class=\"token operator\">:</span> perPage <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">break</span>\n      <span class=\"token keyword\">case</span> ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">MY_CONTENT</span><span class=\"token operator\">:</span>\n        <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">getMyContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> userID<span class=\"token operator\">:</span> userID<span class=\"token punctuation\">,</span> page<span class=\"token operator\">:</span> pageNum<span class=\"token punctuation\">,</span> perPage<span class=\"token operator\">:</span> perPage <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">break</span>\n      <span class=\"token keyword\">case</span> ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">MY_COMMENT</span><span class=\"token operator\">:</span>\n        <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">getMyComments</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> userID<span class=\"token operator\">:</span> userID<span class=\"token punctuation\">,</span> page<span class=\"token operator\">:</span> pageNum<span class=\"token punctuation\">,</span> perPage<span class=\"token operator\">:</span> perPage <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">break</span>\n      <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">break</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">setPage</span><span class=\"token punctuation\">(</span>pageNum<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>대충 봐도 재사용하기 어려운 컴포넌트라는 것을 알 수 있다.</p>\n<p>-문제-</p>\n<ol>\n<li>\n<p>사이드바 메뉴 (즉 게시판 종류) 가 늘어났을 때 switch문 안에 case를 추가할 수 있겠으나 가독성이 떨어진다.</p>\n</li>\n<li>\n<p>또한 Pagination만 하는 컴포넌트인데 컨텐츠를 가져오는 로직이 섞여있어서 유지보수하기 어려워보인다.</p>\n<p>이는 Sidebar에서도 있었던 문제로, 컨텐츠를 가져오는 로직이 여러 군데 퍼져있다.</p>\n</li>\n<li>\n<p>loading 또한 게시판 메뉴가 확장될 때마다 하드코딩해야한다.</p>\n</li>\n</ol>\n<p>따라서 Pagination 컴포넌트의 부모 컴포넌트 역할을 하는 withPaperContainer의 코드를 수정함으로 위 문제를 해결했다.</p>\n<ol>\n<li>Page를 옮겼을 때 새로 컨텐츠를 가져와야 하는 것은 꼭 필요한 로직이기 때문에 Pagination의 부모 컴포넌트에서 prop으로 getPapers 함수를 넘겨준다. (뒤에서 컨텐츠를 가져오는 상태 로직을 커스텀 훅으로 분리할 예정이다.)</li>\n<li>로딩 또한 페이지네이션 컴포넌트가 아닌 부모 컴포넌트에서 처리해준다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// withPaperContainer.tsx</span>\n\n<span class=\"token operator\">**</span><span class=\"token keyword\">let</span> getPapers <span class=\"token operator\">=</span> <span class=\"token function\">Function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">**</span>\n\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">renderPapers</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n            <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>contentSubject<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n                <span class=\"token keyword\">case</span> ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">CLUB_CONTENT</span><span class=\"token operator\">:</span>\n                    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">setTotalDocs</span><span class=\"token punctuation\">(</span>contentsCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token operator\">**</span>getPapers <span class=\"token operator\">=</span> getClubContents<span class=\"token punctuation\">;</span><span class=\"token operator\">**</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token function\">renderContents</span><span class=\"token punctuation\">(</span>clubContents<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t\t\t\t\t\t\t<span class=\"token keyword\">case</span> ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">GROUP_CONTENT</span><span class=\"token operator\">:</span>\n                    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">setTotalDocs</span><span class=\"token punctuation\">(</span>contentsCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token operator\">**</span>getPapers <span class=\"token operator\">=</span> getGroupContents<span class=\"token punctuation\">;</span><span class=\"token operator\">**</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token function\">renderContents</span><span class=\"token punctuation\">(</span>groupContents<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t\t\t\t\t\t<span class=\"token comment\">// ...</span>\n<span class=\"token comment\">// ...</span>\n\n<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                    </span><span class=\"token punctuation\">{</span>loading <span class=\"token operator\">&amp;&amp;</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Loading</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n                    </span><span class=\"token punctuation\">{</span><span class=\"token operator\">!</span>loading <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">renderPapers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n                </span><span class=\"token punctuation\">{</span><span class=\"token operator\">!</span>loading <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">&lt;</span>Pagination <span class=\"token operator\">**</span>getPapers<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>getPapers<span class=\"token punctuation\">}</span><span class=\"token operator\">**</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token punctuation\">)</span></code></pre></div>\n<p>prop으로 받은 getPapers 함수를 통해 switch문을 삭제했다.</p>\n<p>한결 깔끔해진 것 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// Pagination.tsx</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onPageClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>pageNum<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">getPapers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> userID<span class=\"token operator\">:</span> userID<span class=\"token punctuation\">,</span> page<span class=\"token operator\">:</span> pageNum<span class=\"token punctuation\">,</span> perPage<span class=\"token operator\">:</span> perPage <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">setPage</span><span class=\"token punctuation\">(</span>pageNum<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>그런데 위에서 살펴봤듯이 view 로직과 data fetch 로직이 같이 있는 것이 비효율적이라는 생각을 했다.</strong></p>\n<p>그래서 data fetch 로직을 수행하는 custom hook을 만들어서 컴포넌트들이 view 로직만 처리하도록 만들어보자.</p>\n<h3>Custom Hook으로 의존성 분리하기</h3>\n<p>그렇다면 view단 컴포넌트들이 사용하는 상태 관련 로직들이 뭐가 있는지 찾아보자.</p>\n<ol>\n<li>로딩 상태 (현재 fetch 중이어서 로딩 상태인지)</li>\n<li>선택한 글에 따라 해당 글 상세 정보 가져오기 (댓글, 해당 글 내용, 글 작성자 등)</li>\n<li>현재 어느 게시판인지에 따라 data fetch</li>\n<li>pagination 용 정보 (현재 page, total pages)</li>\n</ol>\n<p>글이 길어져, 4에 해당하는 로직을 custom hook으로 추출해서 어떻게 의존성을 분리했는지만 살펴보자.</p>\n<p>리팩토링 이전에는 위에서 살펴봤듯이 Pagination 컴포넌트에는 pagination view를 렌더링하는 로직과 더불어 페이지 클릭 시 (혹은 next, before 버튼 클릭 시) 해당 페이지에 맞는 게시글들을 불러오는 상태 로직이 같이 존재했었다.</p>\n<p>따라서 view 로직만 남겨두어 가독성을 올려보자.</p>\n<ol>\n<li>pagination view를 위한 상태 (전체 페이지 수, 현재 페이지, 한 페이지 당 몇 row 등) 를 usePagination라는 커스텀 훅에서 다룬다.</li>\n<li>게시글 fetch관련 상태 로직을 useFetchPage 라는 커스텀 훅에서 다룬다.</li>\n</ol>\n<p>이렇게 하면 Pagination 컴포넌트에서 상태 로직을 다루지 않고 위 두 custom hook을 구독함으로써 페이지네이션 기능을 구현할 수 있다.</p>\n<p>간략한 코드를 보자.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// usePagination.ts</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">usePagination</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token operator\">**</span><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> getPapers <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useFetchPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">**</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>page<span class=\"token punctuation\">,</span> setPage<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>perPage<span class=\"token punctuation\">,</span> setPerPage<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> totalPages <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">ceil</span><span class=\"token punctuation\">(</span>totalDocs <span class=\"token operator\">/</span> perPage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>pageList<span class=\"token punctuation\">,</span> setPageList<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token function\">Array</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n        <span class=\"token function\">settingPageList</span><span class=\"token punctuation\">(</span>totalPages<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>page<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onPageClick</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>pageNum<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setPage</span><span class=\"token punctuation\">(</span>pageNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">**</span><span class=\"token function\">getPapers</span><span class=\"token punctuation\">(</span>pageNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">**</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onBefore</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onNext</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> page<span class=\"token punctuation\">,</span> perPage<span class=\"token punctuation\">,</span> pageList<span class=\"token punctuation\">,</span> onPageClick <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>useFetchPage 커스텀 훅으로부터 페이지 클릭 시 해당 페이지의 게시글을 렌더링하는 함수를 받아서 사용한다.</p>\n<p>이렇게 하면 상태 관련 로직을 모두 커스텀 훅에서 처리할 수 있다.</p>\n<p>아래는 <del>이제야 좀</del> 단순해진 Pagination 컴포넌트의 모습이다.</p>\n<p>renderPageList로 view 로직만 처리하고 있어 가독성이 훨씬 좋아졌다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Pagination</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">const</span> loading <span class=\"token operator\">=</span> <span class=\"token function\">useBoardLoading</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">**</span><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> page<span class=\"token punctuation\">,</span> pageList<span class=\"token punctuation\">,</span> onPageClick <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">usePagination</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token operator\">**</span>\n\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">renderPageList</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> pageList<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>pageNum <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>pageNum <span class=\"token operator\">===</span> page<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">color</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>primary<span class=\"token punctuation\">'</span></span> <span class=\"token attr-name\">variant</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>outlined<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">onPageClick</span><span class=\"token punctuation\">(</span>pageNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                        </span><span class=\"token punctuation\">{</span>pageNum<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n                    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span> <span class=\"token punctuation\">></span></span>\n                <span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n                    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Button</span></span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">onPageClick</span><span class=\"token punctuation\">(</span>pageNum<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n                        </span><span class=\"token punctuation\">{</span>pageNum<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n                    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Button</span></span> <span class=\"token punctuation\">></span></span>\n                <span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">...</span> <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위에서 withPaperContainer 라는 부모 컴포넌트를 리팩토링해서 재사용성을 높이고자 했는데, custom hook을 통해 해결하면서 부모 컴포넌트의 구조가 더 간결해졌다.</p>\n<p>Pagination 컴포넌트에게 컨텐츠를 불러오는 함수를 내려줄 필요가 없어졌기 때문에 부모 컴포넌트 또한 원래 존재목적대로 렌더링 로직만 남아있게 됐다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token comment\">// withPaperContainer.tsx</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">withPaperContainer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">PaperContainer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n\t\t\t\t\t<span class=\"token punctuation\">.</span>\n\t\t\t\t\t<span class=\"token punctuation\">.</span>\n\t\t\t\t\t<span class=\"token punctuation\">.</span>\n\n\t\t<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">renderPapers</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n\n            <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>contentSubject<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n                <span class=\"token keyword\">case</span> ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">CLUB_CONTENT</span><span class=\"token operator\">:</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token function\">renderContents</span><span class=\"token punctuation\">(</span>clubContents<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">case</span> ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">GROUP_CONTENT</span><span class=\"token operator\">:</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token function\">renderContents</span><span class=\"token punctuation\">(</span>groupContents<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">case</span> ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">MY_CONTENT</span><span class=\"token operator\">:</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token function\">renderContents</span><span class=\"token punctuation\">(</span>myContents<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">case</span> ContentSubject<span class=\"token punctuation\">.</span><span class=\"token constant\">MY_COMMENT</span><span class=\"token operator\">:</span>\n                    <span class=\"token keyword\">return</span> <span class=\"token function\">renderMyComments</span><span class=\"token punctuation\">(</span>myComments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n                    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n\t\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span> <span class=\"token operator\">...</span> <span class=\"token punctuation\">)</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token keyword\">return</span> PaperContainer<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>\n<h3>리팩토링 이후</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3f896d9ecbbe541036d8088981544bf8/e3815/before.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.26582278481012%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABs0lEQVR42n2Sy47TQBBF8wmQhd32JHbbbTt+JIztzMyGHTskkOAHyAOkkLAIC5BY5CNmFBySDSPmRw/qFg6JeCyuunVLdbrqqjuB18f3fTzPM2crz/cJPQ/puTyOejwKXfqBj7BtLMv6pzqhUoRh+FdFSpEMEsajlGdlQZIOiKOI6D/qBEFAKyml0ann+ZKnseJVlhD8qh/l95HSP/POgCqKzGQtVJ9xHFPVY8qyQil18qBEJU9QKjb3lnEE6txGRUFVluR5bprN6kqRxRHDIqUohiSxBoQGktXPyfOh6f0DqNdRSURZlmRZZmCtHypJkQ2oqtrU2umToEccSuTJlp3T/PI05Wo8pq5rRsMhgywjH5UUo0vKmxuur65NLcu1f0maFygVnmV+lqH+OoGK6XkBti0QjotwewjnAiEusCxhfFs4OG4PyxY4jvt7mxao87Jtm+l0wqfPX3gzXTKbr5jNlsznK6az90xmC+bvPjDV3tsVk8mCxfIjL16+xnGEYRyB+v90u102mw3399+5u73l227Hbrdjv9/TNA1N85XD4WDu2ttutzw8/GC9XptezdDAn86INJ0EmamhAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"before\"\n        title=\"\"\n        src=\"/static/3f896d9ecbbe541036d8088981544bf8/f058b/before.png\"\n        srcset=\"/static/3f896d9ecbbe541036d8088981544bf8/c26ae/before.png 158w,\n/static/3f896d9ecbbe541036d8088981544bf8/6bdcf/before.png 315w,\n/static/3f896d9ecbbe541036d8088981544bf8/f058b/before.png 630w,\n/static/3f896d9ecbbe541036d8088981544bf8/40601/before.png 945w,\n/static/3f896d9ecbbe541036d8088981544bf8/78612/before.png 1260w,\n/static/3f896d9ecbbe541036d8088981544bf8/e3815/before.png 2730w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5fe30e30c00be345f33861e16728b820/e3815/after.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.26582278481012%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABsklEQVR42nWQy24TMRSG8wgJi7aTudhje8aTmQYySYpABakgsWDRXFCgCzYg8QoVr5BHKCJtLsAGVHjED41D0kali0+2ftvf8Tm1OAqJhCCKIsTOKlAiQqoDHqiARuwTxIKD/X329vbupaa0Ril1h1gpEqNo5SkPS8vxU0OaWRKTYIy5l1ocx2yQUjpuZ2EkeFkGvDn2iKVAypt7UkZIl8ktO0JtjPvdViol2iScPCt5/qSD0manoE4KtDbE8U22FQopKfKcw6IgTVP0v1FUa5qkWGt38kqSla9ptQ6RQtwVVpUTa+j1e7Tbbfdwc2aM5FE74+joMUVROFnVeqojbLLe/1fYyiy9bpdOp+MepqnFtgqyPKfd7dLv9SnL0v3WZjnWZmijd2a+FVZthGGIMglSKfymRxAGhFISCEkQSZpNz+H7TSIZ0/R9d289glvCqj3P8xiPR3z4+InT4RnDUcU7x2D4lsFwwmi8yc44HUyYTN5z8uKVK7CR1tYzMtTrdabTKdfXv7n4MmM+X3E1X7FcfufyasnscsFy9cPtF4tvfJ3N+fnrD+fnn2k0Gs5RCf8CFIMzsYXe8YwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"after\"\n        title=\"\"\n        src=\"/static/5fe30e30c00be345f33861e16728b820/f058b/after.png\"\n        srcset=\"/static/5fe30e30c00be345f33861e16728b820/c26ae/after.png 158w,\n/static/5fe30e30c00be345f33861e16728b820/6bdcf/after.png 315w,\n/static/5fe30e30c00be345f33861e16728b820/f058b/after.png 630w,\n/static/5fe30e30c00be345f33861e16728b820/40601/after.png 945w,\n/static/5fe30e30c00be345f33861e16728b820/78612/after.png 1260w,\n/static/5fe30e30c00be345f33861e16728b820/e3815/after.png 2730w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>성능 개선을 목표로 리팩토링을 시작한 것은 아니었으나.. 성능 개선에 도움이 된 것 같다.</p>\n<p>다음 글은 사이트 성능 개선을 위한 리팩토링을 해보고 써보자,,,</p>","frontmatter":{"title":"재사용 가능한 컴포넌트 만들기","date":"September 01, 2021","description":null}},"previous":null,"next":{"fields":{"slug":"/2021-12-04-intern/"},"frontmatter":{"title":"인턴으로 스타트업 MVP 개발 후기"}}},"pageContext":{"id":"aa54fbc2-8901-5bc5-bd8b-19356a7f40fc","previousPostId":null,"nextPostId":"2447f97f-4273-5d6e-954a-96ff763f3ee1"}},"staticQueryHashes":["2744905544","2841359383","3257411868"],"slicesMap":{}}