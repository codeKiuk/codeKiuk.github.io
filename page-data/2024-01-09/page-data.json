{"componentChunkName":"component---src-templates-blog-post-js","path":"/2024-01-09/","result":{"data":{"site":{"siteMetadata":{"title":"Juvantia"}},"markdownRemark":{"id":"e4ee26dd-4e0c-5faf-bb0a-66deb4093018","excerpt":"INP https://web.dev/articles/inp 위 아티클을 보면 INP란 무엇인지 디테일하게 알 수 있습니다. 하지만 바쁜 우리들을 위해 간단하게 정리된 걸 먼저 보고 읽으면 좋을 것 같조?? INP란 Overview…","html":"<h1>INP</h1>\n<blockquote>\n<p><a href=\"https://web.dev/articles/inp\">https://web.dev/articles/inp</a></p>\n</blockquote>\n<p>위 아티클을 보면 INP란 무엇인지 디테일하게 알 수 있습니다.</p>\n<p>하지만 바쁜 우리들을 위해 간단하게 정리된 걸 먼저 보고 읽으면 좋을 것 같조??</p>\n<h2>INP란</h2>\n<blockquote>\n<p>Overview</p>\n</blockquote>\n<p>사용자의 페이지 방문 기간동안 발생하는 모든 클릭, 탭, 키보드 등 <strong>상호작용</strong>의 latency를 관찰\n→ 페이지의 전반적인 반응성을 평가하는 지표.</p>\n<blockquote>\n<p>INP를 측정할 때 관찰하는 상호작용(user interaction)</p>\n</blockquote>\n<ul>\n<li><strong><em>Clicking</em></strong> with a mouse.</li>\n<li><strong><em>Tapping</em></strong> on a device with a touchscreen.</li>\n<li>Pressing a key on either a physical or onscreen <strong><em>Keyboard</em></strong>.</li>\n</ul>\n<h2>Why INP?</h2>\n<blockquote>\n<p><em>Chrome usage data shows that 90% of a user's time on a page is spent after it loads, Thus, careful measurement of responsiveness throughout the page lifecycle is important.</em></p>\n</blockquote>\n<p>유저가 페이지에서 사용한 시간 중 90% 는 페이지가 로드된 이후.\n페이지 라이프사이클동안의 반응성이 중요하기 때문에 INP를 도입하기로 한 것</p>\n<blockquote>\n</blockquote>\n<h2>INP vs FID</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c512e2a37f1394dcaf2de9a10afc6388/e8950/inp_vs_fid.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.9746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqElEQVR42pWMS2sTURiGZ6ddaRNQEgtNKgitiO3/cuXWPyFp0WAi0osbBXVRrfWSlroSaeIlbSYzJyY1BhrMpLnMmMuZM4/MTIJu/eDhfd9zvu/V6rUq34WBfnzEh/09DF3HKBsIw0QYAmGKUP1simC3VhFURQWjdEz+8CPFr1/4+eOEjUwazVUerVaLlmWRz3/G6VuMBxZ4DuCAsvGwJ9mm07b5dWZx5rRRSlE5Edh2H3/e7rxEq9VqmIaBECZ6uUK99J5G4SHN0jNOi5tUP2VpFjdp6s85PdqisF/mxcEu2/mnDJwhcigZj8dBYW73FZpvXNfFU4per4fj/MZVIF2F4wzodPsMRxIpVYBSktFgSLfTpWHV6Tht5CgsfLezHRZ6nsf/jlSSg0qOb40CTM5zb16jPX6UZT1zn41seqJTH+a/f+lQJzxYu0t2NUVmNUX2XoonW+vcuX0Lbf7iOXwSE/71AbPnSU6JzASamProDMlImH38W215IYbPzUSMlYV44JeTMVauxrkxf4nFeIQln7koi1ciLE3xc3w2ePP1+lyUa5cv8AdVZt7CWomh5wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"inp_vs_fid\"\n        title=\"\"\n        src=\"/static/c512e2a37f1394dcaf2de9a10afc6388/f058b/inp_vs_fid.png\"\n        srcset=\"/static/c512e2a37f1394dcaf2de9a10afc6388/c26ae/inp_vs_fid.png 158w,\n/static/c512e2a37f1394dcaf2de9a10afc6388/6bdcf/inp_vs_fid.png 315w,\n/static/c512e2a37f1394dcaf2de9a10afc6388/f058b/inp_vs_fid.png 630w,\n/static/c512e2a37f1394dcaf2de9a10afc6388/40601/inp_vs_fid.png 945w,\n/static/c512e2a37f1394dcaf2de9a10afc6388/78612/inp_vs_fid.png 1260w,\n/static/c512e2a37f1394dcaf2de9a10afc6388/e8950/inp_vs_fid.png 2000w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>FID</p>\n</blockquote>\n<ol>\n<li>first interaction의 Input delay가 작으면, 좋은 first impression을 가졌다! 라는 것</li>\n<li>main thread의 long task에 의해 first input delay 가 결정된다.</li>\n<li>input 에 의해 next frame이 그려지는 delay를 측정하지 않는다.</li>\n<li>input에 의해 실행된 event handler의 시간을 측정하지 않는다.</li>\n</ol>\n<h2>INP가 측정하는 것</h2>\n<blockquote>\n<p><em>the intent of INP is not to measure all the eventual effects of the interaction (such as network fetches and UI updates from other asynchronous operations), but the time in which the next paint is being blocked.\n→ &#x3C;</em> 유저의 행동 이후 시각적 피드백이 얼마동안 block되느냐만 보면된다! <em>></em></p>\n</blockquote>\n<p>ensure the time from when a user initiates an interaction until the next frame is painted</p>\n<p>→ &#x3C; 얼마나 빠르게 유저의 interaction에 반응하여 next frame을 그려주냐 ></p>\n<hr>\n<h1>INP 최적화하기</h1>\n<blockquote>\n<p><em>어쨌든 중요한 건 어떻게 INP를 개선하냐!</em></p>\n</blockquote>\n<h2>Interaction 쪼개보기</h2>\n<ol>\n<li>\n<p><strong>Input Delay</strong></p>\n<p>user initiates an interaction ↔ ends when the event callbacks begin</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/21c5b4167b7f103b9dcedaecd2e78b56/77672/input_delay.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.139240506329116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEElEQVR42oVQSU7DQBD0nyMeAeIW5RJxCg8AzvEXwtmXWLaMFxzv8r4VqpbGzAXSUs10z1JV3QYAOI4D0zTR9z1LrOsKFXpeFAXKstzOFfQwuFRliYfdDp+XC6qqgud5+PI8+L6PcRzlYV3XeH58wmG/F+IgCOC6LmzbllwJGUrh4+0d5vks+TAMmKZJoO7p/uV4xOvpJLW6J+Z5xrIsvw5Z6J/10NsiqRrLX7ERqtb+Czqh8F1COuBcsixDnufb8JmrnUjT9K6wMc+LKHNuXdeJAxLa1yssy0IURXLGVknGbnTwrwJrgw+bphG0bStkcRwjDEMEYYjoO0KaZkiSRBxyJ263RDpqW/5tUdeNiP4A5M9noo11d50AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"input_delay\"\n        title=\"\"\n        src=\"/static/21c5b4167b7f103b9dcedaecd2e78b56/f058b/input_delay.png\"\n        srcset=\"/static/21c5b4167b7f103b9dcedaecd2e78b56/c26ae/input_delay.png 158w,\n/static/21c5b4167b7f103b9dcedaecd2e78b56/6bdcf/input_delay.png 315w,\n/static/21c5b4167b7f103b9dcedaecd2e78b56/f058b/input_delay.png 630w,\n/static/21c5b4167b7f103b9dcedaecd2e78b56/40601/input_delay.png 945w,\n/static/21c5b4167b7f103b9dcedaecd2e78b56/77672/input_delay.png 1060w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n</li>\n<li>\n<p><strong>Event Callback <em>( Processing Time )</em></strong></p>\n<p>time for event callbacks to run</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/616ec1b9fba1e4b077f300671ffc091d/77672/event_callback.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.911392405063296%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABEElEQVR42q2Q60oDMRBG+/4vVUWKUrFYQVGENux227WbdLfda65HNkVBRfzjBydhJjNfhpnwi7TWdF1H3/fxbpsm5v7SZDycc7F4xBgTY1kUCCHIsow0TRDphqIssQRMCBhrY+0wDOhBx55Pw6ZpSJIEa21Mhu/feg/lEfaK8FYQ8j1Bm/hktGEtViglz4YfUykp8d7jbYs3VcTpCjeU+KbAiWfcy5KwfgLxSKgVXWfodM3t/Q1lWZ4Nd7stUkratuV0qqnyJTKZotIrZHKJFBcUYoraziiyGbWco49zTvmCh8WKu9dr8mrzdYejxsUrpTDWYa2PaOOQ6oCUI4q+G7DGcThUMR6HCD5Efhj+l94BhFAdu8Vr1zsAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"event_callback\"\n        title=\"\"\n        src=\"/static/616ec1b9fba1e4b077f300671ffc091d/f058b/event_callback.png\"\n        srcset=\"/static/616ec1b9fba1e4b077f300671ffc091d/c26ae/event_callback.png 158w,\n/static/616ec1b9fba1e4b077f300671ffc091d/6bdcf/event_callback.png 315w,\n/static/616ec1b9fba1e4b077f300671ffc091d/f058b/event_callback.png 630w,\n/static/616ec1b9fba1e4b077f300671ffc091d/40601/event_callback.png 945w,\n/static/616ec1b9fba1e4b077f300671ffc091d/77672/event_callback.png 1060w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n</li>\n<li>\n<p><strong>Presentation Delay</strong></p>\n<p>time for the browser to present the next frame <em>( visual result of the interaction )</em></p>\n</li>\n</ol>\n<p><strong><em>위 세개의 phase의 합산 === Total Interaction Latency</em></strong></p>\n<aside>\n💡💡💡 그래서 INP 최적화는 곧 위 세 개의 phase를 최적화한다는 것\n</aside>\n<h2>Optimize Input Delay</h2>\n<blockquote>\n<p>Input Delay 줄이기\n<a href=\"https://web.dev/articles/optimize-input-delay\">https://web.dev/articles/optimize-input-delay</a></p>\n</blockquote>\n<p>간략하게 요약하자면, Input Delay를 줄이려면 아래 세 가지를 하라고 합니다.</p>\n<h3>recurring timers를 피해라 <em>(</em> <code class=\"language-text\">*setInterval*</code> <em>)</em></h3>\n<aside>\n💡 setInterval 사용할 때 main thread를 너무 잡아먹지 않게 setInterval 내에서 하는 일을 줄이라는 게 요지인 듯 합니다.\n</aside>\n<h3>메인 쓰레드에 돌아갈 코드를 잘게 쪼개라 <em>( breaking up long tasks )</em></h3>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\">textBox<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">inputEvent</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// UI 업데이트를 다음 프레임에서 바로 볼 수 있도록</span>\n  <span class=\"token comment\">// UI 업데이트는 즉각적으로 하기</span>\n  <span class=\"token function\">updateTextBox</span><span class=\"token punctuation\">(</span>inputEvent<span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">// Use `setTimeout` to defer all other work until at lehast the next</span>\n  <span class=\"token comment\">// frame by queuing a task in a `requestAnimationFrame()` callback.</span>\n  <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> textBox<span class=\"token punctuation\">.</span>textContent\n      <span class=\"token function\">updateWordCount</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n      <span class=\"token function\">checkSpelling</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n      <span class=\"token function\">saveChanges</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>Interaction Overlap 의 문제</h3>\n<ol>\n<li>network 요청때문에 느리다면, Debouncing, <code class=\"language-text\">AbortController</code>의 fetch abort로 해결해라</li>\n<li>애니메이션때문에 느리다면, JS 애니메이션 말고 css를 사용하고, composition 애니메이션으로 해결하려고 노력해라</li>\n</ol>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1372b0877bb76c3fd22d34a05d0cc938/07a9c/interaction_overlap.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.60759493670886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXUlEQVR42m2QbW/TMBSF+/9/yL4xBhoTIDbxaRICBqNjNE3jNsma16bxlnVNHTsPcrt0oeJKV/f42Ofo+A6klNR1jTEtRmtkfEHhv6YI3pDPjpHzM9Q6QdULquWEeHRM5p4Qj96STU65n52gHgOaRm/1A2MMbdvSVR5+xr0+ogg/kPtnrIsLmuqK5vEXSXBJlXzkaXHOXHwiHJ/yMH/H5n64DWR9BjZdv5RqKEu5xVWlcCYp3jQi9sc4w5/cDh+YiTv+XJ1z/eML324cRkKQRg5a1QyssJ9QqQ1SljtcK9JsSZpmLKfvcb8fEU4aosBl/PUV4veQqEjwxByZC1qz+dfQzrIsiZOY1WpF/25drxD+DXmREoQh0TKj5UW3//Khod1p15a209ZiUeC6DmI6xfM87gIf3ahnnUHr5v+GfXy4DqOf9sJ9P7/RWu8Mu1T9dIdcf1phh7u25x3f8hd/I2Ms3/nzJwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"interaction_overlap\"\n        title=\"\"\n        src=\"/static/1372b0877bb76c3fd22d34a05d0cc938/f058b/interaction_overlap.png\"\n        srcset=\"/static/1372b0877bb76c3fd22d34a05d0cc938/c26ae/interaction_overlap.png 158w,\n/static/1372b0877bb76c3fd22d34a05d0cc938/6bdcf/interaction_overlap.png 315w,\n/static/1372b0877bb76c3fd22d34a05d0cc938/f058b/interaction_overlap.png 630w,\n/static/1372b0877bb76c3fd22d34a05d0cc938/40601/interaction_overlap.png 945w,\n/static/1372b0877bb76c3fd22d34a05d0cc938/78612/interaction_overlap.png 1260w,\n/static/1372b0877bb76c3fd22d34a05d0cc938/07a9c/interaction_overlap.png 1440w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<blockquote>\n<p>after you've interacted with one element,\nyou make another interaction with the page before the initial interaction has had a chance to render the next frame.</p>\n</blockquote>\n<hr>\n<h2>Optimize Event Callback <em>( Processing Time )</em></h2>\n<h3>Visual Updates 이외의 task들은 Yield하기</h3>\n<blockquote>\n<p>아래와 일맥상통하는 얘기\n메인 쓰레드에 돌아갈 코드를 잘게 쪼개라 <em>( breaking up long tasks )</em></p>\n</blockquote>\n<p>다만 여기서는 <code class=\"language-text\">requestAnimationFrame</code>을 사용해서, visual feedback을 블락하지 않는 것에 더 초점을 두었네요!</p>\n<p>위 Optimize Input Delay에서 썼던 코드보다 더 큰 장점은, <code class=\"language-text\">requestAnimationFrame</code>을 통해 UI update와는 무관한 코드가 next frame을 블락하지 않도록 하면서, 모든 브라우저에서 동작한다는 거라네요</p>\n<p><img src=\"Untitled%205.png\" alt=\"Untitled\"></p>\n<h3>레이아웃 Thrashing 줄이기</h3>\n<blockquote>\n<p><a href=\"https://web.dev/articles/avoid-large-complex-layouts-and-layout-thrashing\">https://web.dev/articles/avoid-large-complex-layouts-and-layout-thrashing</a></p>\n</blockquote>\n<p>Layout Thrashing?\n<em>-forced synchronous layout-</em>\n<strong>JavaScript로 스타일을 업데이트할 때 발생</strong></p>\n<blockquote>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d6514850918697c937767c05451ae769/acf8f/layout_thrashing.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.822784810126581%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA6klEQVR42hXMzUqDAADAcR8u6CmCDn0QdalgnTLqHaLAQ7cuYek+REvTrRZF7cOgctOFLlkdcqC5Gezwj34P8BNmqcc0PKX4UCgimd9Yxm/HPNkTujcpz3cZbSel4+R0Hj+xghpmr4YTGNiBwVWvitXX0D2VMAkQ/rNva57x/TJJc5Gf5hzG0TnHYoIkRkhijLQ35GR/xOHBKyV1nVJllS11ie3yCjuVNXa1TTbkBfQ3BWGW+UzCM4qhyjS6oIgV/PaIlp3j3ma8PGR0GyluPcdtfXEdaFx6VRoDi/rAxOxr2L6O4ZWJxu/8AYghxAlNIqVwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"layout_thrasing\"\n        title=\"\"\n        src=\"/static/d6514850918697c937767c05451ae769/f058b/layout_thrashing.png\"\n        srcset=\"/static/d6514850918697c937767c05451ae769/c26ae/layout_thrashing.png 158w,\n/static/d6514850918697c937767c05451ae769/6bdcf/layout_thrashing.png 315w,\n/static/d6514850918697c937767c05451ae769/f058b/layout_thrashing.png 630w,\n/static/d6514850918697c937767c05451ae769/40601/layout_thrashing.png 945w,\n/static/d6514850918697c937767c05451ae769/78612/layout_thrashing.png 1260w,\n/static/d6514850918697c937767c05451ae769/acf8f/layout_thrashing.png 1340w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>원래는 JS run → style calculation → layout 인데, Layout Thrashing이 발생하면\nJS run → style calculation → layout → JS run → style calculation → layout 이 된다</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">logBoxHeight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>box<span class=\"token punctuation\">.</span>offsetHeight<span class=\"token punctuation\">)</span>\n\n  box<span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'super-big'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token comment\">//  console.log(box.offsetHeight);</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h2>Optimize Presentation Delay</h2>\n<h3>DOM size 최소화</h3>\n<blockquote>\n<p><a href=\"https://web.dev/articles/dom-size-and-interactivity\">https://web.dev/articles/dom-size-and-interactivity</a></p>\n</blockquote>\n<p>DOM size 와 rendering work 는 linear한 관계는 아니라고 하네요 ㅎㅎ</p>\n<p>DOM size가 크다의 기준?\n<a href=\"https://developer.chrome.com/en/docs/lighthouse/performance/dom-size/#how-the-lighthouse-dom-size-audit-fails\">Lighthouse에 따르면 1,400개의 노드를 넘으면 크다고 봅니다</a></p>\n<blockquote>\n</blockquote>\n<ol>\n<li>Flattening DOM Structure</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n   \n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n       \n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n           \n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n               \n        <span class=\"token comment\">&lt;!-- Contents --></span>\n             \n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n         \n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n     \n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>컴포넌트 기반 라이브러리 사용중이면 <code class=\"language-text\">Fragment</code> 적극 활용해라!</p>\n<h3>DOM size를 줄일 수 없다면?</h3>\n<ol>\n<li>Additive Approach</li>\n</ol>\n<blockquote>\n<p>lazy load HTML에 관한 얘기</p>\n</blockquote>\n<p>(첫 렌더때 모든 HTML을 가져오지 않고 필요할 때만 가져오는 이 방식에서)\n주의할 점은 user interaction에 대해 HTML을 가져올 때, in-flight network request는 INP를 계산할 때 제외되지만, ui latency가 있을 수 있다\n→ skeleton 등으로 해결해야함</p>\n<blockquote>\n</blockquote>\n<ol>\n<li>CSS-selector 복잡도 줄이기</li>\n</ol>\n<blockquote>\n<p><a href=\"https://web.dev/articles/reduce-the-scope-and-complexity-of-style-calculations\">https://web.dev/articles/reduce-the-scope-and-complexity-of-style-calculations</a></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.box:nth-last-child(-n+1) .title</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/* styles */</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>BEM 스타일을 사용하는 이유 : 단순한 CSS selector 사용을 위해.. → 성능 이점도 존재했다!</p>\n<ol>\n<li><code class=\"language-text\">content-visibility</code> 사용하기</li>\n</ol>\n<blockquote>\n<p><a href=\"https://web.dev/articles/content-visibility\">https://web.dev/articles/content-visibility</a></p>\n</blockquote>\n<ul>\n<li>첫 렌더때 rendering work를 줄여준다</li>\n<li>user interaction으로 인해 DOM이 변경될 때 offscreen 엘리먼트들의 rendering work를 스킵한다</li>\n</ul>\n<h3><strong>Be aware of performance costs when rendering HTML using JavaScript</strong></h3>\n<blockquote>\n<p><a href=\"https://web.dev/articles/client-side-rendering-of-html-and-interactivity\">https://web.dev/articles/client-side-rendering-of-html-and-interactivity</a></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">saveSettings</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Create an array of functions to run:</span>\n  <span class=\"token keyword\">const</span> tasks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>validateForm<span class=\"token punctuation\">,</span> showSpinner<span class=\"token punctuation\">,</span> saveToDatabase<span class=\"token punctuation\">,</span> updateUI<span class=\"token punctuation\">,</span> sendAnalytics<span class=\"token punctuation\">]</span>\n\n  <span class=\"token comment\">// Loop over the tasks:</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>tasks<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Shift the first task off the tasks array:</span>\n    <span class=\"token keyword\">const</span> task <span class=\"token operator\">=</span> tasks<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// Run the task:</span>\n    <span class=\"token function\">task</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// Yield to the main thread:</span>\n    <span class=\"token keyword\">await</span> <span class=\"token function\">yieldToMain</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"title":"2024.3에 Web Vital이 될 INP","date":"January 09, 2024","description":null}},"previous":{"fields":{"slug":"/2023-02-28-url-search-params/"},"frontmatter":{"title":"URL SearchParams 와 react-query의 편리한 data fetching orchestration"}},"next":null},"pageContext":{"id":"e4ee26dd-4e0c-5faf-bb0a-66deb4093018","previousPostId":"82ca94aa-233e-5d93-b9b8-34b7a2372dff","nextPostId":null}},"staticQueryHashes":["2744905544","2841359383","3257411868"],"slicesMap":{}}